var initCanvas=function(t,e){"use strict";var s=document.querySelector(t),n=s.getContext(e);return s.style.height="250px",s.style.width="250px",s.style.backgroundColor="orange",{canvas:s,context:n,width:"250px",height:"250px",bg:"orange",shapesCount:0,isDrawable:!1,currentEventListenerCount:0,imgCount:0,setHeight:function(t){return this.height=t,s.style.height=t,this},setWidth:function(t){return this.width=t,s.style.width=t,this},setBG:function(t){return this.bg=t,s.style.backgroundColor=t,this},rectangle:function(t,e,s,r){return n.fillStyle=e,n.lineWidth=s,n.strokeStyle=r,n.fillRect.apply(n,t),n.strokeRect.apply(n,t),this.currentShapes=this.currentShapes||{},this.currentShapes[this.shapesCount]={cords:t,fill:e,lineWidth:s,strokeStyle:r},this.shapesCount+=1,this},circle:function(t,e,s,r,i,h){return n.beginPath(),n.arc(t,e,s,0,2*Math.PI,!0),n.fillStyle=r,n.fill(),n.lineWidth=i,n.strokeStyle=h,n.stroke(),this.currentShapes=this.currentShapes||{},this.currentShapes[this.shapesCount]={centerX:t,centerY:e,radius:s,strokeStyle:h,fillStyle:r,lineWidth:i},this.shapesCount+=1,this},makeDrawable:function(t,e,r){this.isDrawable=!0;var i,h=[],a=[],o=[],u=function(t,e,s){h.push(t),a.push(e),o.push(s)},c=function(){n.clearRect(0,0,n.canvas.width,n.canvas.height),n.strokeStyle=t,n.lineJoin=e,n.lineWidth=r;for(var s=0;s<h.length;s++)n.beginPath(),o[s]&&s?n.moveTo(h[s-1],a[s-1]):n.moveTo(h[s]-1,a[s]),n.lineTo(h[s],a[s]),n.closePath(),n.stroke()},l=function(t){t.pageX-this.offsetLeft,t.pageY-this.offsetTop;i=!0,u(t.pageX-this.offsetLeft,t.pageY-this.offsetTop)},v=function(t){i&&(u(t.pageX-this.offsetLeft,t.pageY-this.offsetTop,!0),c())},f=function(){i=!1};return s.addEventListener("mousedown",l),s.addEventListener("mousemove",v),s.addEventListener("mouseup",f),s.addEventListener("mouseleave",f),this.currentEventListeners=this.currentEventListeners||{},this.currentEventListeners[this.currentEventListenerCount]={mousedown:{name:"msdn",val:l},mousemove:{name:"msm",val:v},mouseup:{name:"pfalse",val:f},mouseleave:{name:"pfalse",val:f}},this.currentEventListenerCount+=1,this},drawImg:function(t,e,s,r,i,h,a,o,u){if("string"==typeof t){var c=new Image;c.src=t}var t=c||t;return n.drawImage(t,e,s,r,i,h,a,o,u),this.currentImgs=this.currentImgs||{},this.currentImgs[this.imgCount]={source:t,srcX:e,srcY:s,srcWidth:r,srcHeight:i,destX:h,destY:a,destWidth:o,destHeight:u},this},clearCanvas:function(){return n.clearRect(0,0,n.canvas.width,n.canvas.height),this},removeEvtListeners:function(){for(var t in this.currentEventListeners){var e=this.currentEventListeners[t];for(var n in e)s.removeEventListener(n,e[n].val)}return this.currentEventListenerCount=0,this.currentEventListeners=null,this},resetAll:function(){return s.style.backgroundColor="transparent",s.style.width="auto",s.style.height="auto",this.removeEvtListeners(),this.clearCanvas(),this.currentEventListenerCount=0,this.bg="transparent",this.currentShapes=null,this.height="auto",this.width="auto",this.isDrawable=!1,this.shapesCount=0,this.imgCount=0,this.currentImgs=null,this},save:function(){return n.save(),this},restore:function(){return n.restore(),this}}};